import{_ as $,r as d,o as b,c as r,a as l,b as e,t as f,d as a,u as w,w as S,s as C,e as c,f as h,g as x,F as B,h as D,i as I,j as H}from"./index-ByinR5q9.js";import{H as N}from"./Header-WQbM4sA5.js";import{C as A,F}from"./Card-5eaP5XeC.js";import{B as k}from"./Button--kJKo-mJ.js";import{g as V,f as P,d as T,a as U,b as j}from"./api-Cad0ROAR.js";/* empty css                                                               */const M={class:"thumbnail-cell"},q={class:"item-thumbnail"},E=["src"],L={class:"info-cell"},O={class:"item-title"},R={class:"item-time"},W={class:"item-resolution"},z={class:"node-count-cell"},G={class:"node-count"},J={class:"action-cell"},K={__name:"ScreenshotItem",props:{screenshot:{type:Object,required:!0}},emits:["click","deleted"],setup(v,{emit:p}){const o=v,i=p,u=d("加载中..."),_=d(""),m=d("...");b(async()=>{const s=new Image;s.onload=function(){u.value=`${this.naturalWidth} × ${this.naturalHeight}`};const t=`/api/uploads/${o.screenshot.filename}`;s.src=t,_.value=t;try{const n=await V(o.screenshot.id);m.value=n.nodes?n.nodes.length:0}catch(n){console.error("获取节点数量失败",n),m.value="?"}});function y(){confirm(`确定要删除截图 #${o.screenshot.id} 吗？`)&&g()}async function g(){try{await T(o.screenshot.id),C("截图删除成功"),i("deleted",o.screenshot.id)}catch(s){console.error("删除截图失败",s)}}return(s,t)=>(l(),r("tr",{class:"screenshot-item",onClick:t[0]||(t[0]=n=>s.$emit("click"))},[e("td",M,[e("div",q,[e("img",{src:_.value,alt:"截图缩略图",class:"thumbnail-image"},null,8,E)])]),e("td",L,[e("div",O,"截图 #"+f(v.screenshot.id),1),e("div",R,[t[1]||(t[1]=e("span",{class:"info-label"},"上传时间：",-1)),a(f(w(P)(v.screenshot.upload_time)),1)]),e("div",W,[t[2]||(t[2]=e("span",{class:"info-label"},"分辨率：",-1)),a(f(u.value),1)])]),e("td",z,[e("div",G,f(m.value),1)]),e("td",J,[e("button",{class:"delete-button",onClick:S(y,["stop"])}," 删除 ")])]))}},Q=$(K,[["__scopeId","data-v-a2e169fa"]]),X={class:"container"},Y={class:"page-header"},Z={class:"screenshot-container"},ee={key:0,class:"screenshots-count"},te={key:0,class:"loading-item"},se={key:1,class:"empty-item"},oe={class:"empty-content"},ne={key:2,class:"screenshot-table"},le={__name:"HomePage",setup(v){const p=x(),o=d([]),i=d(!0);d(!1),b(async()=>{try{const s=await U();o.value=s.screenshots||[]}catch(s){console.error("加载截图列表失败",s)}finally{i.value=!1}});function u(){p.push("/upload")}function _(s){p.push(`/detail/${s}`)}function m(){confirm("确定要清空所有截图吗？此操作不可恢复！")&&y()}async function y(){try{i.value=!0,await j(),o.value=[],C("所有截图已清空")}catch(s){console.error("清空截图失败",s)}finally{i.value=!1}}function g(s){o.value=o.value.filter(t=>t.id!==s)}return(s,t)=>(l(),r("div",X,[c(N),e("div",Y,[t[1]||(t[1]=e("div",{class:"header-title"},[e("h1",null,"Android截图列表"),e("p",{class:"header-description"},"查看和管理所有上传的Android UI截图及节点")],-1)),c(k,{onClick:u,icon:"📤"},{default:h(()=>t[0]||(t[0]=[a("上传新截图")])),_:1})]),e("div",Z,[c(A,null,{header:h(()=>[t[3]||(t[3]=e("h5",null,[e("span",{class:"card-icon"},"📋"),a(" 所有截图")],-1)),!i.value&&o.value.length>0?(l(),r("div",ee,[a(f(o.value.length)+" 个截图 ",1),c(k,{onClick:m,type:"danger",small:""},{default:h(()=>t[2]||(t[2]=[a("清空所有截图")])),_:1})])):H("",!0)]),default:h(()=>[i.value?(l(),r("div",te,t[4]||(t[4]=[e("span",{class:"spinner"},null,-1),a(" 加载中... ")]))):o.value.length===0?(l(),r("div",se,[e("div",oe,[t[6]||(t[6]=e("div",{class:"empty-icon"},"📱",-1)),t[7]||(t[7]=e("div",{class:"empty-text"},"暂无截图",-1)),c(k,{onClick:u,type:"primary",small:""},{default:h(()=>t[5]||(t[5]=[a("上传第一张截图")])),_:1})])])):(l(),r("table",ne,[t[8]||(t[8]=e("thead",null,[e("tr",null,[e("th",null,"缩略图"),e("th",null,"截图信息"),e("th",null,"节点数量"),e("th",null,"操作")])],-1)),e("tbody",null,[(l(!0),r(B,null,D(o.value,n=>(l(),I(Q,{key:n.id,screenshot:n,onClick:ae=>_(n.id),onDeleted:g},null,8,["screenshot","onClick"]))),128))])]))]),_:1})]),c(F)]))}},he=$(le,[["__scopeId","data-v-b273c31f"]]);export{he as default};
