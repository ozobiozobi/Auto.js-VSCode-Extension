import{_ as k,r as i,c as J,e as d,b as s,f as p,g as I,a as h,d as r,w as C,k as j,v as U,t as D,l as c,s as P}from"./index-ByinR5q9.js";import{H as T}from"./Header-WQbM4sA5.js";import{C as A,F as B}from"./Card-5eaP5XeC.js";import{B as S}from"./Button--kJKo-mJ.js";import{u as R}from"./api-Cad0ROAR.js";/* empty css                                                               */const E={class:"container"},V={class:"page-header"},H={class:"upload-content"},q={class:"form-group"},G={class:"file-upload-container"},M={class:"file-upload-ui"},L={key:0,class:"file-preview"},$=["src"],z={key:1,class:"upload-placeholder"},K={class:"form-group"},Q={class:"form-group"},W={class:"form-submit"},X={__name:"UploadPage",setup(Y){const _=I(),v=i(null),u=i(null),n=i(""),a=i(!1),m=i(null);function w(){_.push("/")}function N(l){const e=l.target.files[0];if(e){const o=new FileReader;o.onload=t=>{m.value=t.target.result},o.readAsDataURL(e)}}function O(l){const e=l.target.files[0];if(e){const o=new FileReader;o.onload=function(t){n.value=t.target.result},o.readAsText(e)}}async function y(){if(!v.value.files[0]){c("è¯·é€‰æ‹©æˆªå›¾æ–‡ä»¶");return}if(!n.value&&!u.value.files[0]){c("è¯·æä¾›èŠ‚ç‚¹JSONæ•°æ®ï¼ˆä¸Šä¼ æ–‡ä»¶æˆ–ç²˜è´´å†…å®¹ï¼‰");return}try{a.value=!0;const l=new FormData;if(l.append("screenshot",v.value.files[0]),n.value)try{const o=JSON.parse(n.value);console.log("è§£æžçš„JSONæ•°æ®æ ¼å¼éªŒè¯ï¼š",Object.keys(o).join(",")),o.bounds||console.warn("è­¦å‘Šï¼šJSONæ•°æ®å¯èƒ½ç¼ºå°‘boundså­—æ®µ"),l.append("nodeJson",n.value)}catch(o){console.error("JSONè§£æžé”™è¯¯:",o),c("èŠ‚ç‚¹JSONæ ¼å¼æ— æ•ˆï¼Œè¯·æ£€æŸ¥"),a.value=!1;return}else if(u.value.files[0]){const o=u.value.files[0],t=new FileReader;try{const f=await new Promise((F,x)=>{t.onload=g=>F(g.target.result),t.onerror=g=>x(g),t.readAsText(o)}),b=JSON.parse(f);console.log("è§£æžçš„JSONæ–‡ä»¶æ ¼å¼éªŒè¯ï¼š",Object.keys(b).join(",")),b.bounds||console.warn("è­¦å‘Šï¼šJSONæ•°æ®å¯èƒ½ç¼ºå°‘boundså­—æ®µ"),l.append("nodeJson",f)}catch(f){console.error("JSONæ–‡ä»¶è§£æžé”™è¯¯:",f),c("èŠ‚ç‚¹JSONæ–‡ä»¶æ ¼å¼æ— æ•ˆï¼Œè¯·æ£€æŸ¥"),a.value=!1;return}}console.log("å¼€å§‹ä¸Šä¼ æˆªå›¾å’ŒèŠ‚ç‚¹æ•°æ®");const e=await R(l);if(e&&e.screenshot_id){console.log("ä¸Šä¼ æˆåŠŸï¼Œæˆªå›¾ID:",e.screenshot_id);const o=e.screenshot_id;P("æˆªå›¾ä¸Šä¼ æˆåŠŸï¼",{duration:2500,onClose:()=>{console.log("Toastå·²å…³é—­ï¼Œå‡†å¤‡è·³è½¬åˆ°è¯¦æƒ…é¡µ"),_.push(`/detail/${o}`)}})}else console.error("ä¸Šä¼ æˆåŠŸä½†æœªè¿”å›žscreenshot_id"),c("ä¸Šä¼ æˆåŠŸä½†è¿”å›žæ•°æ®ä¸å®Œæ•´")}catch(l){console.error("ä¸Šä¼ è¿‡ç¨‹å‡ºé”™:",l)}finally{a.value=!1}}return(l,e)=>(h(),J("div",E,[d(T),s("div",V,[e[2]||(e[2]=s("div",{class:"header-title"},[s("h1",null,"ä¸Šä¼ Androidæˆªå›¾"),s("p",{class:"header-description"},"ä¸Šä¼ æˆªå›¾å’ŒUIèŠ‚ç‚¹æ•°æ®è¿›è¡Œåˆ†æž")],-1)),d(S,{type:"ghost",onClick:w,icon:"ðŸ”™"},{default:p(()=>e[1]||(e[1]=[r("è¿”å›žåˆ—è¡¨")])),_:1})]),s("div",H,[d(A,null,{header:p(()=>e[3]||(e[3]=[s("h5",null,[s("span",{class:"card-icon"},"ðŸ“¤"),r(" ä¸Šä¼ æˆªå›¾å’ŒèŠ‚ç‚¹ä¿¡æ¯")],-1)])),default:p(()=>[s("form",{onSubmit:C(y,["prevent"]),class:"upload-form"},[s("div",q,[e[5]||(e[5]=s("label",{for:"screenshotFile",class:"form-label"},[s("span",{class:"label-icon"},"ðŸ“·"),r(" æˆªå›¾æ–‡ä»¶ "),s("span",{class:"required-field"},"*")],-1)),s("div",G,[s("input",{type:"file",id:"screenshotFile",ref_key:"screenshotFileInput",ref:v,class:"file-input",accept:"image/*",required:"",onChange:N},null,544),s("div",M,[m.value?(h(),J("div",L,[s("img",{src:m.value,alt:"é¢„è§ˆ",class:"preview-image"},null,8,$)])):(h(),J("div",z,e[4]||(e[4]=[s("span",{class:"upload-icon"},"ðŸ“±",-1),s("span",null,"ç‚¹å‡»æˆ–æ‹–æ‹½æˆªå›¾åˆ°æ­¤å¤„",-1)])))])]),e[6]||(e[6]=s("div",{class:"form-text"},"æ”¯æŒPNGã€JPGæ ¼å¼çš„Androidè®¾å¤‡æˆªå›¾",-1))]),s("div",K,[e[7]||(e[7]=s("label",{for:"nodeJsonFile",class:"form-label"},[s("span",{class:"label-icon"},"ðŸ“„"),r(" èŠ‚ç‚¹JSONæ–‡ä»¶ ")],-1)),s("input",{type:"file",id:"nodeJsonFile",ref_key:"nodeJsonFileInput",ref:u,class:"form-control",accept:".json",onChange:O},null,544),e[8]||(e[8]=s("div",{class:"form-text"},"é€‰æ‹©åŒ…å«UIèŠ‚ç‚¹ä¿¡æ¯çš„JSONæ–‡ä»¶",-1))]),s("div",Q,[e[9]||(e[9]=s("label",{for:"nodeJson",class:"form-label"},[s("span",{class:"label-icon"},"ðŸ“"),r(" æˆ–ç›´æŽ¥ç²˜è´´èŠ‚ç‚¹JSON ")],-1)),j(s("textarea",{id:"nodeJson","onUpdate:modelValue":e[0]||(e[0]=o=>n.value=o),class:"form-control",rows:"8",placeholder:"ç²˜è´´èŠ‚ç‚¹JSONæ•°æ®åˆ°è¿™é‡Œ"},null,512),[[U,n.value]]),e[10]||(e[10]=s("div",{class:"form-text"},"ä»Žå¼€å‘è€…å·¥å…·å¯¼å‡ºçš„UIèŠ‚ç‚¹JSONæ•°æ®",-1))]),s("div",W,[d(S,{type:"primary",loading:a.value,disabled:a.value,icon:"ðŸ“¤",block:!0},{default:p(()=>[r(D(a.value?"ä¸Šä¼ ä¸­...":"ä¸Šä¼ æˆªå›¾"),1)]),_:1},8,["loading","disabled"])])],32)]),_:1})]),d(B)]))}},ae=k(X,[["__scopeId","data-v-bc6ee0ea"]]);export{ae as default};
